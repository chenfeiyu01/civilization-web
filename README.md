# 文明战棋 - Web版

一个类似文明6的回合制战棋游戏，支持单人对战AI。

## 功能特性

### 已实现功能 ✅

#### 六边形地图系统
- 使用Axial坐标系统实现六边形网格
- 6种地形类型：平原、丘陵、山脉、水域、森林、沙漠
- 每种地形有不同的移动消耗和防御加成
- 地图视图控制：右键拖拽平移、滚轮缩放
- 地图自动生成，包含地形平滑算法

#### 单位系统
- 5种单位类型：
  - **战士** ⚔️ - 近战单位，高血量高防御
  - **弓箭手** 🏹 - 远程单位，2格攻击范围
  - **骑兵** 🐴 - 高机动单位，4格移动距离
  - **殖民者** 🚶 - 可建造城市
  - **工人** 🔨 - 民事单位
- 单位移动力系统
- 可移动范围高亮显示
- 单位血量条显示

#### 城市与生产系统 🆕
- **城市建造**：殖民者可在任意位置建造城市
- **城市资源**：每个城市每回合产出食物、生产力、金币
- **人口增长**：城市随时间自动增长人口
- **单位生产**：可在城市中训练新单位
- **生产队列**：支持多个单位排队生产
- **城市面板**：查看城市详情、管理生产

#### 战斗系统
- 攻击/防御数值计算
- 地形防御加成（丘陵+25%，森林+15%）
- 伤害计算考虑单位当前血量
- 单位死亡和消灭判定

#### 回合制系统
- 玩家回合与AI回合交替
- 每回合重置单位行动力
- 城市生产和人口增长处理
- 回合数显示

#### AI对手
- 简单AI决策系统
- 自动追踪玩家单位
- 优先攻击血量最低的敌人

#### 动画系统 🆕
- **动画管理器**：管理单位移动、攻击动画
- **粒子引擎**：攻击特效、城市建造特效
- **伤害数字**：战斗时显示浮动伤害数字
- **平滑动画**：使用requestAnimationFrame实现流畅动画

#### 用户界面
- 开始界面（地图大小设置）
- 游戏信息面板（回合、单位信息、帝国统计、游戏日志）
- 城市管理面板
- 生产选择器
- 胜利/失败画面
- 操作提示

## 技术栈

- **前端**: React 18 + TypeScript + Vite
- **状态管理**: Zustand
- **样式**: TailwindCSS
- **地图渲染**: HTML5 Canvas
- **后端**: Node.js + Express + TypeScript（预留扩展）

## 项目结构

```
civ6-web-game/
├── client/                 # 前端代码
│   ├── src/
│   │   ├── components/     # React组件
│   │   │   ├── GameBoard/  # 游戏主界面
│   │   │   ├── HexGrid/    # 六边形地图渲染
│   │   │   └── UI/         # 用户界面组件
│   │   │       ├── CityPanel.tsx        # 城市面板
│   │   │       ├── ProductionQueue.tsx  # 生产队列
│   │   │       └── ProductionPicker.tsx # 生产选择器
│   │   ├── game/           # 游戏核心逻辑
│   │   │   ├── map/        # 地图生成和渲染
│   │   │   ├── ai/         # AI决策系统
│   │   │   └── animation/  # 动画系统 🆕
│   │   │       ├── AnimationManager.ts  # 动画管理器
│   │   │       └── ParticleEngine.ts    # 粒子引擎
│   │   ├── store/          # Zustand状态管理
│   │   └── main.tsx        # 入口文件
│   └── index.html
├── server/                 # 后端代码（预留）
│   └── src/
│       └── index.ts
├── shared/                 # 前后端共享代码
│   └── src/types/          # 类型定义
│       ├── map.ts          # 地图相关类型
│       ├── units.ts        # 单位相关类型
│       ├── game.ts         # 游戏核心类型
│       ├── city.ts         # 城市类型 🆕
│       └── animation.ts    # 动画类型 🆕
└── package.json
```

## 快速开始

### 环境要求

- Node.js 18+
- npm 9+

### 安装与运行

```bash
# 克隆仓库
git clone https://github.com/chenfeiyu01/civilization-web.git
cd civilization-web

# 安装依赖
npm install

# 启动前端开发服务器
npm run dev:client
```

访问 http://localhost:3000 开始游戏！

### 其他命令

```bash
# 同时启动前端和后端
npm run dev

# 构建生产版本
npm run build

# 类型检查
npm run type-check
```

## 游戏操作

| 操作 | 功能 |
|------|------|
| 左键点击单位 | 选择己方单位 |
| 左键点击空地 | 移动选中的单位（绿色高亮区域） |
| 左键点击敌人 | 攻击敌方单位（红色高亮区域） |
| 左键点击城市 | 打开城市管理面板 |
| 右键拖拽 | 平移地图 |
| 滚轮 | 缩放地图 |
| 结束回合按钮 | 结束当前回合，轮到AI行动 |

## 游戏规则

### 胜利条件
消灭所有敌方单位即可获得胜利！

### 城市系统 🆕

| 资源 | 作用 |
|------|------|
| 🌾 食物 | 促进人口增长 |
| ⚙️ 生产力 | 用于单位生产 |
| 💰 金币 | （预留） |

### 单位生产成本 🆕

| 单位 | 生产力成本 |
|------|------------|
| 战士 | 40 |
| 弓箭手 | 50 |
| 骑兵 | 60 |
| 殖民者 | 80 |
| 工人 | 35 |

### 地形效果

| 地形 | 移动消耗 | 防御加成 | 可通行 |
|------|----------|----------|--------|
| 平原 | 1 | 0% | ✅ |
| 丘陵 | 2 | +25% | ✅ |
| 山脉 | ∞ | +50% | ❌ |
| 水域 | 1 | 0% | ✅ |
| 森林 | 2 | +15% | ✅ |
| 沙漠 | 1 | -10% | ✅ |

### 单位属性

| 单位 | 血量 | 攻击 | 防御 | 移动 | 射程 | 视野 |
|------|------|------|------|------|------|------|
| 战士 | 100 | 25 | 20 | 2 | 1 | 2 |
| 弓箭手 | 70 | 20 | 10 | 2 | 2 | 3 |
| 骑兵 | 90 | 22 | 15 | 4 | 1 | 3 |
| 殖民者 | 50 | 0 | 5 | 2 | 0 | 2 |
| 工人 | 50 | 0 | 5 | 2 | 0 | 1 |

## 更新日志

### v0.2.0 (开发中)
- 🏙️ 新增城市与生产系统
  - 殖民者可建造城市
  - 城市产出资源（食物、生产力、金币）
  - 人口增长系统
  - 单位生产队列
  - 城市管理面板
- ✨ 新增动画系统
  - 动画管理器（移动、攻击动画）
  - 粒子引擎（攻击、建造特效）
  - 伤害数字浮动显示
- 🎨 UI优化
  - 城市面板和生产选择器
  - 帝国统计显示
  - 城市在地图上的渲染

### v0.1.0 (2024-02-12)
- 🎉 初始版本发布
- ✅ 实现六边形地图系统
- ✅ 实现单位系统（战士、弓箭手、骑兵）
- ✅ 实现战斗系统
- ✅ 实现回合制系统和简单AI
- ✅ 实现基础UI界面

## 后续计划

- [x] 城市与生产系统
- [x] 视觉效果优化（动画、粒子特效）
- [ ] 科技树系统
- [ ] 更多战斗单位
- [ ] 文明特性
- [ ] 多人在线对战
- [ ] 存档系统

## 贡献

欢迎提交 Issue 和 Pull Request！

## 许可证

MIT License
